{% extends "helpdesk/base.html" %}{% load i18n humanize %}{% load url from future %}

{% block helpdesk_title %}{% trans "Tickets" %}{% endblock %}

{% block helpdesk_head %}
<script type='text/javascript' language='javascript' src='{{ STATIC_URL }}helpdesk/filter.js'></script>
{% endblock helpdesk_head %}

{% block helpdesk_body %}
<div class="page-header">
    <h1>Tickets{% if from_saved_query %} <small>[{{ saved_query.title }}]</small>{% endif %}</h1>
</div>

{% include "helpdesk/include/ticket-filter.html" %}

<div class="row">
{{ search_message|safe }}
    <form method='post' action='{% url 'helpdesk_mass_update' %}' id="ticket_mass_update">
        {% csrf_token %}
{% include "helpdesk/include/ticket-list.html" %}
        <div class="pagination">
            <span class="step-links">
                {% if tickets.has_previous %}
                    <a href="?{% if query_string %}{{ query_string }}&amp;{% endif %}page={{ tickets.previous_page_number }}">{% trans "Previous" %}</a>
                {% endif %}

                <span class="current">
                    {% blocktrans with tickets.number as ticket_num and tickets.paginator.num_pages as num_pages %}Page {{ ticket_num }} of {{ num_pages }}.{% endblocktrans %}
                </span>

                {% if tickets.has_next %}
                    <a href="?{% if query_string %}{{ query_string }}&amp;{% endif %}page={{ tickets.next_page_number }}">{% trans "Next" %}</a>
                {% endif %}
            </span>
        </div>

        <p><label>{% trans "Select:" %}</label> <a href='#select_all' id='select_all'>{% trans "All" %}</a> <a href='#select_none' id='select_none'>{% trans "None" %}</a> <a href='#select_inverse' id='select_inverse'>{% trans "Inverse" %}</a></p>

        <p><label for='id_mass_action'>{% trans "With Selected Tickets:" %}</label> <select name='action' id='id_mass_action'><option value='take'>{% trans "Take (Assign to me)" %}</option><option value='delete'>{% trans "Delete" %}</option><optgroup label='{% trans "Close" %}'><option value='close'>{% trans "Close (Don't Send E-Mail)" %}</option><option value='close_public'>{% trans "Close (Send E-Mail)" %}</option></optgroup><optgroup label='{% trans "Assign To" %}'><option value='unassign'>{% trans "Nobody (Unassign)" %}</option>{% for u in user_choices %}<option value='assign_{{ u.id }}'>{{ u.username }}</option>{% endfor %}</optgroup></select> <input type='submit' value='Go' /></p>
    </form>
{% endblock helpdesk_body %}
</div>
